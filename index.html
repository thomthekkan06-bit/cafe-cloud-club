<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Café Cloud Club | Order</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        /* --- RESET & VARIABLES --- */
        :root {
            --primary: #FF4500; 
            --secondary: #2d3436;
            --bg: #F9FAFC;
            --white: #ffffff;
            --dark-text: #2d3436;
            --grey-text: #8395a7;
            --radius: 12px;
            --shadow: 0 4px 12px rgba(0,0,0,0.05);
            --veg-color: #27ae60;
            --non-veg-color: #c0392b;
            --disabled: #bdc3c7;
            --discount-color: #e67e22;
        }

        * { box-sizing: border-box; outline: none; }
        
        body {
            font-family: 'Poppins', sans-serif;
            margin: 0;
            background-color: var(--bg);
            color: var(--secondary);
            height: 100vh;
            display: flex;
            overflow: hidden; 
            transition: background-color 0.3s ease, color 0.3s ease;
        }

        /* --- LAYOUT GRID --- */
        .dashboard {
            display: grid;
            grid-template-columns: 220px 1fr 320px; 
            width: 100%;
            height: 100%;
            transition: opacity 0.3s ease;
        }

        /* --- 1. LEFT SIDEBAR (CATEGORIES) --- */
        .left-sidebar {
            background: var(--white);
            border-right: 1px solid #eee;
            padding: 20px;
            display: flex;
            flex-direction: column;
            overflow-y: auto;
            transition: background-color 0.3s ease, border-color 0.3s ease;
        }

        .left-sidebar .brand-title {
            font-size: 1.4rem;
            margin-bottom: 2px; 
            color: var(--primary);
            font-weight: 700;
            line-height: 1.2;
        }

        .brand-subtitle {
            font-size: 0.85rem;
            color: var(--secondary);
            font-weight: 500;
            margin-bottom: 2px;
        }

        .brand-est {
            font-size: 0.7rem;
            color: #b2bec3;
            font-style: italic;
            margin-bottom: 15px; 
            letter-spacing: 0.5px;
        }

        /* --- STORE TIMINGS BOX --- */
        .store-timings-box {
            background: #f8f9fa;
            border: 1px solid #eee;
            border-radius: 8px;
            padding: 10px;
            margin-bottom: 10px;
            font-size: 0.75rem;
            color: var(--grey-text);
        }
        
        .store-timings-box h4 {
            margin: 0 0 5px 0;
            color: var(--primary);
            font-size: 0.8rem;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .timing-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 3px;
        }

        /* --- STORE ADDRESS BOX (Desktop) --- */
        .store-address-box {
            background: #f8f9fa;
            border: 1px solid #eee;
            border-radius: 8px;
            padding: 10px;
            margin-bottom: 20px;
            font-size: 0.75rem;
            color: var(--grey-text);
        }

        .store-address-box h4 {
            margin: 0 0 5px 0;
            color: var(--primary);
            font-size: 0.8rem;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .store-address-box p {
            margin: 0 0 5px 0;
            line-height: 1.4;
        }

        .store-address-box a {
            color: var(--secondary);
            text-decoration: none;
            font-weight: 600;
        }

        /* --- FILTERS --- */
        .filter-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .filter-item {
            font-weight: 500;
            color: var(--grey-text);
            cursor: pointer;
            padding: 12px 15px;
            border-radius: 8px;
            font-size: 0.9rem;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .filter-item:hover {
            background: #fff0eb;
            color: var(--primary);
        }

        .filter-item.active {
            color: var(--primary);
            background: #fff0eb;
            font-weight: 700;
            border-right: 3px solid var(--primary);
        }

        /* --- 2. MAIN CONTENT (CENTER) --- */
        .main-content {
            padding: 20px 30px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            background: var(--bg);
            transition: background-color 0.3s ease;
        }

        /* --- NEW: MOBILE INFO CARD STYLES --- */
        .mobile-info-card {
            display: none; /* Hidden on Desktop */
            background: var(--white);
            padding: 15px;
            border-radius: 12px;
            margin-bottom: 20px;
            border: 1px solid #eee;
            text-align: center;
            box-shadow: var(--shadow);
            transition: background-color 0.3s ease, border-color 0.3s ease;
        }

        .mobile-brand-title {
            color: var(--primary);
            font-size: 1.3rem;
            font-weight: 700;
            margin: 0 0 10px 0;
        }

        .mobile-info-row {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            font-size: 0.85rem;
            color: var(--secondary);
            margin-bottom: 5px;
            line-height: 1.4;
        }
        
        .mobile-info-row.small-text {
            font-size: 0.75rem;
            color: var(--grey-text);
            margin-top: 8px;
            border-top: 1px dashed #eee;
            padding-top: 8px;
        }

        .mobile-info-row a {
            color: var(--secondary);
            text-decoration: none;
            font-weight: 600;
        }

        .header-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            gap: 20px;
            flex-shrink: 0;
        }
        
        .search-box {
            background: var(--white);
            padding: 10px 15px;
            border-radius: 10px;
            flex: 1; 
            display: flex;
            align-items: center;
            gap: 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.03);
            border: 1px solid #eee;
            transition: background-color 0.3s ease, border-color 0.3s ease;
        }
        
        .search-box input {
            border: none;
            width: 100%;
            font-family: inherit;
            font-size: 0.9rem;
            background: transparent;
            color: inherit;
        }

        /* --- PROMO BANNERS --- */
        .promo-section {
            display: flex;
            gap: 15px;
            overflow-x: auto;
            padding-bottom: 10px; 
            margin-bottom: 20px;
            scroll-behavior: smooth;
            scrollbar-width: none; 
            -ms-overflow-style: none;
            flex-shrink: 0;      
            min-height: 190px;   
            width: 100%;          
            z-index: 10;
            position: relative;
        }
        
        .promo-section::-webkit-scrollbar { display: none; }

        .promo-card {
            min-width: 280px;
            height: 150px;
            border-radius: 15px;
            padding: 20px;
            color: white;
            display: flex;
            flex-direction: column;
            justify-content: center;
            position: relative;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            cursor: pointer;
            transition: transform 0.2s ease;
            flex-shrink: 0; 
        }

        .promo-card:hover { transform: translateY(-3px); }
        .promo-card h3 { margin: 0 0 5px 0; font-size: 1.4rem; font-weight: 700; }
        .promo-card p { margin: 0 0 15px 0; font-size: 0.85rem; opacity: 0.9; line-height: 1.4; }
        .code-badge { background: rgba(255,255,255,0.2); padding: 5px 12px; border-radius: 6px; font-weight: 600; font-size: 0.9rem; width: fit-content; border: 1px dashed rgba(255,255,255,0.6); }
        .promo-icon { position: absolute; right: -10px; bottom: -10px; font-size: 100px; opacity: 0.2; transform: rotate(-15deg); }

        /* Gradients */
        .bg-gradient-1 { background: linear-gradient(135deg, #FF4500, #ff9f43); }
        .bg-gradient-2 { background: linear-gradient(135deg, #8e44ad, #3498db); }
        .bg-gradient-3 { background: linear-gradient(135deg, #11998e, #38ef7d); }
        .bg-gradient-4 { background: linear-gradient(135deg, #eb3349, #f45c43); }

        /* --- FILTERS --- */
        .advanced-filters {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
            align-items: center;
            flex-shrink: 0;
        }

        .adv-select {
            padding: 8px 12px;
            border-radius: 20px;
            border: 1px solid #ddd;
            background: var(--white);
            color: var(--secondary);
            font-size: 0.85rem;
            cursor: pointer;
            font-family: inherit;
            min-width: 100px;
        }

        .toggle-chip {
            padding: 8px 15px;
            border-radius: 20px;
            border: 1px solid #ddd;
            background: var(--white);
            color: var(--secondary);
            font-size: 0.85rem;
            cursor: pointer;
            transition: 0.2s;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .toggle-chip.active { background: var(--secondary); color: var(--white); border-color: var(--secondary); }

        .mobile-cart-btn {
            display: none;
            background: var(--primary);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 50px;
            cursor: pointer;
            font-weight: 600;
            box-shadow: 0 4px 15px rgba(255, 69, 0, 0.4);
            z-index: 100;
        }

        /* --- MENU ITEMS --- */
        .menu-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(240px, 1fr)); 
            gap: 15px;
            padding-bottom: 80px; 
            flex-grow: 1;
        }

        .food-card {
            background: var(--white);
            border-radius: var(--radius);
            padding: 15px;
            box-shadow: var(--shadow);
            transition: transform 0.2s, background-color 0.3s ease;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            border-left: 4px solid #ccc;
            min-height: 100px;
        }

        .food-card.veg { border-left-color: var(--veg-color); }
        .food-card.non-veg { border-left-color: var(--non-veg-color); }
        .food-card:hover { transform: translateY(-3px); }
        .card-top { margin-bottom: 10px; }
        .food-title { font-weight: 600; font-size: 0.95rem; margin-bottom: 3px; color: var(--secondary); line-height: 1.3; display: flex; align-items: center; }
        .type-emoji { margin-right: 6px; font-size: 0.85rem; }
        .food-meta { font-size: 0.7rem; color: var(--grey-text); font-weight: 500; text-transform: uppercase; padding-left: 2px; margin-bottom: 10px; }

        /* --- OPTIONS --- */
        .options-area { margin: 10px 0; padding-top: 10px; border-top: 1px dashed #eee; }
        .option-label { display: block; font-size: 0.8rem; color: var(--grey-text); margin-bottom: 4px; cursor: pointer; }
        .option-label input { margin-right: 5px; accent-color: var(--primary); }
        .note-input { width: 100%; padding: 8px; border: 1px solid #eee; background: #f9f9f9; border-radius: 6px; font-size: 0.8rem; margin-top: 5px; font-family: inherit; }
        .price-row { display: flex; justify-content: space-between; align-items: center; margin-top: 10px; }
        .price { font-weight: 700; font-size: 1.1rem; color: var(--secondary); }
        .add-btn-mini { background: #f1f2f6; color: var(--secondary); padding: 6px 15px; border-radius: 20px; border: none; cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 0.85rem; font-weight: 600; transition: 0.2s; gap: 5px; }
        .add-btn-mini:hover { background: var(--primary); color: white; }

        /* --- 3. RIGHT SIDEBAR (CART) --- */
        .order-sidebar { background: var(--white); padding: 25px; display: flex; flex-direction: column; border-left: 1px solid #eee; height: 100vh; transition: background-color 0.3s ease, border-color 0.3s ease; }
        .cart-header-mobile { display: none; align-items: center; margin-bottom: 20px; padding-bottom: 15px; border-bottom: 1px solid #eee; }
        .back-btn { background: transparent; border: none; font-size: 1.2rem; color: var(--primary); cursor: pointer; display: flex; align-items: center; gap: 10px; font-weight: 600; }
        .section-title { font-size: 1.1rem; font-weight: 600; margin-bottom: 15px; color: var(--secondary); }
        .cart-items-container { flex: 1; overflow-y: auto; margin-bottom: 15px; padding-right: 5px; }
        .cart-item { display: flex; justify-content: space-between; margin-bottom: 12px; align-items: flex-start; padding-bottom: 12px; border-bottom: 1px solid #f5f5f5; }
        .cart-details { flex: 1; padding-right: 5px; }
        .cart-name { font-size: 0.85rem; font-weight: 600; margin-bottom: 2px; display: block; color: var(--secondary); line-height: 1.3; }
        .cart-price { font-size: 0.8rem; color: var(--grey-text); }
        .qty-wrapper { display: flex; align-items: center; gap: 8px; background: #F4F6F8; padding: 2px 6px; border-radius: 6px; transition: background-color 0.3s ease; height: 28px; }
        .qty-btn { border: none; background: transparent; cursor: pointer; font-weight: bold; color: var(--secondary); font-size: 0.9rem; padding: 0 4px;}
        
        .coupon-section { margin-bottom: 15px; display: flex; gap: 8px; }
        .coupon-input { flex: 1; padding: 10px; border: 1px solid #ddd; border-radius: 8px; font-family: inherit; font-size: 0.85rem; text-transform: uppercase; }
        .coupon-btn { border: none; padding: 0 15px; border-radius: 8px; font-weight: 600; font-size: 0.85rem; transition: all 0.3s ease; }
        .coupon-btn:not(:disabled) { background-color: var(--primary); color: white; cursor: pointer; box-shadow: 0 2px 8px rgba(255, 69, 0, 0.3); }
        .coupon-btn:not(:disabled):hover { background-color: #e03e00; }
        .coupon-btn:disabled { background-color: #e0e0e0; color: #888; cursor: not-allowed; box-shadow: none; }
        .coupon-msg { font-size: 0.8rem; margin-bottom: 10px; min-height: 1.2em; }
        .coupon-msg.error { color: #e74c3c; }
        .coupon-msg.success { color: #27ae60; }

        .cart-summary { border-top: 1px solid #eee; padding-top: 15px; }
        .summary-row { display: flex; justify-content: space-between; margin-bottom: 10px; font-size: 0.9rem; color: var(--grey-text); }
        .summary-row.discount-row { color: var(--discount-color); font-weight: 600; }
        .summary-total { color: var(--secondary); font-weight: 700; font-size: 1.2rem; margin-top: 10px; margin-bottom: 20px; color: var(--primary); }
        .checkout-btn { background: var(--primary); color: white; width: 100%; padding: 14px; border: none; border-radius: 10px; font-size: 0.95rem; font-weight: 600; cursor: pointer; box-shadow: 0 4px 10px rgba(255, 69, 0, 0.2); transition: 0.3s; }
        .checkout-btn:disabled { background: var(--disabled); cursor: not-allowed; box-shadow: none; }

        /* --- MODAL --- */
        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); display: none; align-items: center; justify-content: center; z-index: 2000; backdrop-filter: blur(4px); }
        .modal-card { background: white; padding: 30px; border-radius: 20px; width: 90%; max-width: 400px; box-shadow: 0 10px 40px rgba(0,0,0,0.2); max-height: 90vh; overflow-y: auto; transition: background-color 0.3s ease; }
        .modal-card h3 { color: var(--secondary); }
        .input-group { margin-bottom: 15px; }
        .input-group label { display: block; font-size: 0.8rem; color: var(--grey-text); margin-bottom: 5px; }
        .input-field { width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 8px; font-family: inherit; background: white; color: var(--secondary); }
        select.input-field { appearance: none; background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e"); background-repeat: no-repeat; background-position: right 1rem center; background-size: 1em; }

        .radio-group { display: flex; gap: 15px; margin-bottom: 20px; padding-bottom: 15px; border-bottom: 1px solid #eee; }
        .radio-label { display: flex; align-items: center; cursor: pointer; font-weight: 500; font-size: 0.9rem; color: var(--secondary); }
        .radio-label input { margin-right: 8px; accent-color: var(--primary); width: 16px; height: 16px; }

        /* --- SUCCESS SCREEN --- */
        .success-screen { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: var(--white); z-index: 3000; flex-direction: column; align-items: center; justify-content: center; text-align: center; padding: 40px; }
        .success-icon-container { width: 80px; height: 80px; background: #e3f9e5; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-bottom: 20px; animation: bounceIn 0.8s ease; }
        .success-icon { font-size: 40px; color: var(--veg-color); }
        .success-title { font-size: 1.8rem; color: var(--secondary); font-weight: 700; margin-bottom: 10px; }
        .success-subtitle { font-size: 1rem; color: var(--grey-text); margin-bottom: 40px; max-width: 400px; }
        .action-buttons-container { display: flex; flex-direction: column; gap: 15px; width: 100%; max-width: 320px; }
        .whatsapp-final-btn { background: #25D366; color: white; padding: 16px 30px; border-radius: 50px; font-size: 1.1rem; font-weight: 600; border: none; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 10px; box-shadow: 0 4px 15px rgba(37, 211, 102, 0.4); transition: transform 0.2s; text-decoration: none; width: 100%; }
        .call-final-btn { background: var(--primary); color: white; padding: 16px 30px; border-radius: 50px; font-size: 1.1rem; font-weight: 600; border: none; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 10px; box-shadow: 0 4px 15px rgba(255, 69, 0, 0.3); transition: transform 0.2s; text-decoration: none; width: 100%; }
        .whatsapp-final-btn:hover, .call-final-btn:hover { transform: translateY(-2px); }
        @keyframes bounceIn { 0% { transform: scale(0); opacity: 0; } 50% { transform: scale(1.2); } 100% { transform: scale(1); opacity: 1; } }

        /* Responsive Breakpoints */
        @media (max-width: 1000px) {
            .dashboard { grid-template-columns: 1fr; grid-template-rows: auto 1fr; display: flex; flex-direction: column; }
            .left-sidebar { grid-row: 1; width: 100%; border-right: none; border-bottom: 1px solid #eee; padding: 10px 20px; flex-direction: row; overflow-x: auto; align-items: center; gap: 10px; height: auto; flex-shrink: 0; }
            
            /* HIDE Desktop Sidebar Info */
            .left-sidebar .brand-title, .brand-subtitle, .brand-est, .store-timings-box, .store-address-box { display: none; }

            /* SHOW Mobile Info Card */
            .mobile-info-card { display: block; }

            .filter-list { flex-direction: row; width: 100%; }
            .filter-item { white-space: nowrap; padding: 8px 12px; background: #f1f2f6; border-radius: 20px; border: 1px solid #ddd; }
            .filter-item.active { border-right: 1px solid var(--primary); border-color: var(--primary); }
            .main-content { flex: 1; padding: 20px; }
            .order-sidebar { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 2000; background: var(--bg); padding: 20px; overflow-y: auto; }
            .order-sidebar.active { display: flex; }
            .cart-header-mobile { display: flex; }
            .mobile-cart-btn { display: block; position: fixed; bottom: 20px; right: 20px; z-index: 1500; transition: transform 0.2s ease; }
        }

        /* --- DARK MODE --- */
        @media (prefers-color-scheme: dark) {
            :root { --bg: #121212; --white: #1e1e1e; --secondary: #ecf0f1; --dark-text: #ecf0f1; --grey-text: #a4b0be; --shadow: 0 4px 12px rgba(0,0,0,0.5); --disabled: #555; }
            .left-sidebar, .order-sidebar, .cart-item, .radio-group, .cart-summary, .options-area, .coupon-input, .cart-header-mobile, .store-timings-box, .store-address-box, .mobile-info-card { border-color: #333 !important; }
            .search-box, .input-field, .filter-item, .note-input, .adv-select, .toggle-chip, .mobile-info-row.small-text { border-color: #444 !important; }
            .search-box, .input-field, .qty-wrapper, .note-input, .adv-select, .toggle-chip, .coupon-input { background-color: #2d3436 !important; color: var(--secondary) !important; }
            .toggle-chip.active { background: var(--secondary) !important; color: var(--white) !important; }
            .add-btn-mini { background: #2d3436; color: #fff; }
            .filter-item { background-color: #1e1e1e; }
            .filter-item:hover { background: #333; color: var(--primary); }
            .filter-item.active { background: #2d3436; }
            .store-timings-box, .store-address-box, .mobile-info-card { background: #2d3436; }
            .store-address-box a, .mobile-info-row a { color: var(--secondary); }
            .modal-card { background: #1e1e1e; color: var(--secondary); }
            .success-screen { background: #121212; }
            .success-icon-container { background: #0f3d16; }
            .coupon-btn:disabled { background-color: #444; color: #888; }
            select.input-field { background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%23ecf0f1' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e"); }
            ::-webkit-scrollbar { width: 8px; }
            ::-webkit-scrollbar-track { background: #121212; }
            ::-webkit-scrollbar-thumb { background: #444; border-radius: 4px; }
        }
    </style>
</head>
<body>

<div class="success-screen" id="success-view">
    <div class="success-icon-container">
        <i class="fas fa-check success-icon"></i>
    </div>
    <h1 class="success-title">Order Ready, <span id="customer-name-display"></span>!</h1>
    <p class="success-subtitle">Your order details are ready. Please click the button below to send them to us via WhatsApp.</p>
    
    <div class="action-buttons-container">
        <button class="whatsapp-final-btn" id="send-wa-btn">
            <i class="fab fa-whatsapp"></i> Send Order to WhatsApp
        </button>
        
        <a href="tel:+917907660093" class="call-final-btn">
            <i class="fas fa-phone-alt"></i> Call to Confirm
        </a>
    </div>
</div>

<div class="dashboard" id="main-dashboard">
    <div class="left-sidebar">
        <h2 class="brand-title">Café Cloud Club</h2>
        <div class="brand-subtitle">Cafe and Eatery</div>
        <div class="brand-est">Established Since 2021</div>

        <div class="store-timings-box">
            <h4><i class="far fa-clock"></i> Store Timings</h4>
            <div class="timing-row">
                <span>Pickup/Dine-In:</span>
                <span>3pm - 3am</span>
            </div>
            <div class="timing-row">
                <span>Delivery:</span>
                <span>2pm - 3am</span>
            </div>
        </div>

        <div class="store-address-box">
            <h4><i class="fas fa-map-marker-alt"></i> Location</h4>
            <p>Opposite KFC, Muringoor,<br>Chalakudy, Kerala 680309</p>
            <p>
                <a href="tel:+917907660093"><i class="fas fa-phone-alt"></i> +91 79076 60093</a>
            </p>
        </div>

        <div class="filter-list">
            <div class="filter-item active" onclick="setCategoryFilter('All', this)">All Items</div>
            <div class="filter-item" onclick="setCategoryFilter('Bun-Tastic Burgers', this)">Bun-Tastic Burgers</div>
            <div class="filter-item" onclick="setCategoryFilter('Butcher\'s Best', this)">Butcher's Best</div>
            <div class="filter-item" onclick="setCategoryFilter('Italian Indulgence', this)">Italian Indulgence</div>
            <div class="filter-item" onclick="setCategoryFilter('Freshly Folded', this)">Freshly Folded</div>
            <div class="filter-item" onclick="setCategoryFilter('Rice Harmony', this)">Rice Harmony</div>
            <div class="filter-item" onclick="setCategoryFilter('Salad Symphony', this)">Salad Symphony</div>
            <div class="filter-item" onclick="setCategoryFilter('Toasty Treats', this)">Toasty Treats</div>
            <div class="filter-item" onclick="setCategoryFilter('Warm Whispers', this)">Warm Whispers</div>
            <div class="filter-item" onclick="setCategoryFilter('Nibbles & Bits', this)">Nibbles & Bits</div>
            <div class="filter-item" onclick="setCategoryFilter('Icy Sips', this)">Icy Sips</div>
            <div class="filter-item" onclick="setCategoryFilter('Mojito Magic', this)">Mojito Magic</div>
            <div class="filter-item" onclick="setCategoryFilter('Nature\'s Nectar', this)">Nature's Nectar</div>
            <div class="filter-item" onclick="setCategoryFilter('Whipped Wonders', this)">Whipped Wonders</div>
            <div class="filter-item" onclick="setCategoryFilter('Frosted Leaf', this)">Frosted Leaf</div>
            <div class="filter-item" onclick="setCategoryFilter('ADD-ON', this)">ADD-ON</div>
        </div>
    </div>

    <div class="main-content">
        <div class="mobile-info-card">
            <h2 class="mobile-brand-title">Café Cloud Club</h2>
            <div class="mobile-info-row">
                <i class="fas fa-map-marker-alt"></i> Opposite KFC, Muringoor, Chalakudy
            </div>
            <div class="mobile-info-row">
                <a href="tel:+917907660093"><i class="fas fa-phone-alt"></i> +91 79076 60093</a>
            </div>
            <div class="mobile-info-row small-text">
                <i class="far fa-clock"></i> Pickup: 3pm-3am | Delivery: 2pm-3am
            </div>
        </div>

        <div class="header-bar">
            <div class="search-box">
                <i class="fas fa-search" style="color: #ccc;"></i>
                <input type="text" id="search-input" placeholder="Search..." onkeyup="updateSearch()">
            </div>
            <button class="mobile-cart-btn" onclick="toggleCartPage()">
                <i class="fas fa-shopping-bag"></i> View Cart <span id="mobile-count">(0)</span>
            </button>
        </div>

        <div class="promo-section">
            <div class="promo-card bg-gradient-1" onclick="copyCode('CLOUD15')">
                <h3>15% OFF</h3>
                <p>Combo: Burger + Fries + Drink<br>Strictly 1 of each!</p>
                <div class="code-badge">Use: CLOUD15</div>
                <i class="fas fa-hamburger promo-icon"></i>
            </div>

            <div class="promo-card bg-gradient-2" onclick="copyCode('STEAK13')">
                <h3>Steak & Sip</h3>
                <p>13% OFF on Butcher's Best<br>+ Whipped Wonder Shake</p>
                <div class="code-badge">Use: STEAK13</div>
                <i class="fas fa-drumstick-bite promo-icon"></i>
            </div>

            <div class="promo-card bg-gradient-3" onclick="copyCode('QUICK20')">
                <h3>Quick Bite 20%</h3>
                <p>Any Wrap + Side Dish<br>Perfect for a light lunch!</p>
                <div class="code-badge">Use: QUICK20</div>
                <i class="fas fa-stopwatch promo-icon"></i>
            </div>

            <div class="promo-card bg-gradient-4" onclick="copyCode('FEAST14')">
                <h3>Family Feast</h3>
                <p>14% OFF Huge Order<br>2 Burgers, 2 Mains & more</p>
                <div class="code-badge">Use: FEAST14</div>
                <i class="fas fa-users promo-icon"></i>
            </div>
        </div>

        <div class="advanced-filters">
            <select class="adv-select" onchange="setSort(this.value)">
                <option value="default">Sort By...</option>
                <option value="low-high">Price: Low to High</option>
                <option value="high-low">Price: High to Low</option>
            </select>

            <select class="adv-select" onchange="setType(this.value)">
                <option value="all">Diet: All</option>
                <option value="veg">Veg Only</option>
                <option value="non-veg">Non-Veg Only</option>
            </select>

            <select class="adv-select" onchange="setIngredient(this.value)">
                <option value="all">Ingredient: All</option>
                <option value="Chicken">Chicken</option>
                <option value="Beef">Beef</option>
                <option value="Fish">Fish</option>
                <option value="Panner">Paneer</option>
            </select>

            <div class="toggle-chip" onclick="toggleUnder200(this)" id="price-chip">
                <i class="fas fa-tag"></i> Under ₹200
            </div>
        </div>

        <div class="menu-grid" id="menu-root">
            </div>
    </div>

    <div class="order-sidebar" id="cart-sidebar">
        <div class="cart-header-mobile">
            <button class="back-btn" onclick="toggleCartPage()">
                <i class="fas fa-arrow-left"></i> Back to Menu
            </button>
        </div>

        <div style="display:flex; justify-content:space-between; align-items:center;">
            <div class="section-title" style="margin:0;">Current Order</div>
        </div>
        <br>
        
        <div class="cart-items-container" id="cart-items-list">
            </div>
        
        <div class="coupon-section">
            <input type="text" id="coupon-input" class="coupon-input" placeholder="COUPON CODE">
            <button class="coupon-btn" id="coupon-apply-btn" onclick="applyCoupon()" disabled>APPLY</button>
        </div>
        <div id="coupon-msg" class="coupon-msg"></div>

        <div class="cart-summary">
            <div class="summary-row">
                <span>Sub Total</span>
                <span id="sub-total">0</span>
            </div>
            <div class="summary-row">
                <span>Packing Charges</span>
                <span id="packing-total">0</span>
            </div>
            
            <div class="summary-row discount-row" id="discount-row" style="display:none;">
                <span>Coupon (15% OFF)</span>
                <span id="discount-total">-0</span>
            </div>

            <div class="summary-row">
                <span>Delivery Fee</span>
                <span>Calculated by Agent</span>
            </div>
            <div class="summary-row summary-total">
                <span>Total</span>
                <span id="grand-total">0</span>
            </div>
            <button class="checkout-btn" id="main-checkout-btn" onclick="openCheckoutModal()" disabled>Cart Empty</button>
        </div>
    </div>
</div>

<div class="modal-overlay" id="checkout-modal">
    <div class="modal-card">
        <h3 style="margin-top: 0; margin-bottom: 15px;">Checkout</h3>
        
        <div class="radio-group">
            <label class="radio-label">
                <input type="radio" name="orderType" value="Delivery" checked onchange="toggleOrderFields()"> Delivery
            </label>
            <label class="radio-label">
                <input type="radio" name="orderType" value="Pickup" onchange="toggleOrderFields()"> Pickup / Dine-In
            </label>
        </div>

        <div class="input-group">
            <label>Full Name</label>
            <input type="text" class="input-field" id="c-name" placeholder="John Doe">
        </div>
        <div class="input-group">
            <label>Phone Number (10 digits)</label>
            <input type="tel" class="input-field" id="c-phone" placeholder="9876543210" pattern="[0-9]*">
        </div>
        <div class="input-group">
            <label>Email Address</label>
            <input type="email" class="input-field" id="c-email" placeholder="john@example.com">
        </div>

        <div class="input-group">
            <label id="time-label">Preferred Delivery Time</label>
            <select class="input-field" id="c-time">
                <option value="" disabled selected>Select a time...</option>
                <option value="ASAP">ASAP (Standard)</option>
                <option value="In 30-45 mins">In 30-45 mins</option>
                <option value="In 1 Hour">In 1 Hour</option>
                <option value="In 1.5 Hours">In 1.5 Hours</option>
                <option value="In 2 Hours">In 2 Hours</option>
                <option value="Schedule Later (Call to confirm)">Schedule Later (Call to confirm)</option>
            </select>
        </div>
        
        <div class="input-group" id="address-group">
            <label>Delivery Address</label>
            <textarea class="input-field" id="c-address" rows="3" placeholder="Flat No, Street, Landmark..."></textarea>
        </div>

        <div class="input-group">
            <label>Special Instructions (Optional)</label>
            <textarea class="input-field" id="c-instruction" rows="2" placeholder='e.g. "Doorbell doesn&#39;t work", "Dog in"'></textarea>
        </div>

        <button class="checkout-btn" onclick="finalizeOrder()">Confirm Order</button>
        <button style="background:none; border:none; width:100%; padding:10px; margin-top:10px; cursor:pointer; color:#777;" onclick="closeCheckoutModal()">Cancel</button>
    </div>
</div>

<script>
    /* --- DATA --- */
    const whatsappNumber = "917907660093";
    const MIN_ORDER_VAL = 200; 
    
    // Website Icons
    const vegIcon = decodeURIComponent('%F0%9F%9F%A2'); 
    const nonVegIcon = decodeURIComponent('%F0%9F%94%B4');
    const rupeeSign = decodeURIComponent('%E2%82%B9');

    const menuData = [
        // (Copying your exact data)
        { name: "Cheesy Beef Melt", price: 180, category: "Bun-Tastic Burgers", type: "non-veg" },
        { name: "Cheesy Chicken Melt", price: 200, category: "Bun-Tastic Burgers", type: "non-veg" },
        { name: "Chicken Slider Burger - Pesto", price: 90, category: "Bun-Tastic Burgers", type: "non-veg" },
        { name: "Chicken Slider Burger - Tandoori", price: 90, category: "Bun-Tastic Burgers", type: "non-veg" },
        { name: "Chicken Zinger Burger", price: 190, category: "Bun-Tastic Burgers", type: "non-veg" },
        { name: "Classic Beef Burger", price: 160, category: "Bun-Tastic Burgers", type: "non-veg" },
        { name: "Cloud Special Chicken Burger", price: 190, category: "Bun-Tastic Burgers", type: "non-veg" },
        { name: "Double Decker Beef Burger", price: 220, category: "Bun-Tastic Burgers", type: "non-veg" },
        { name: "Egg Burger", price: 100, category: "Bun-Tastic Burgers", type: "non-veg" },
        { name: "Honey Bbq Chicken Burger", price: 190, category: "Bun-Tastic Burgers", type: "non-veg" },
        { name: "Pesto Chicken Burger", price: 190, category: "Bun-Tastic Burgers", type: "non-veg" },
        { name: "Tandoori Burger Chicken", price: 170, category: "Bun-Tastic Burgers", type: "non-veg" },
        { name: "Tandoori Special Chicken Burger", price: 180, category: "Bun-Tastic Burgers", type: "non-veg" },
        { name: "Tropical Beef Burger", price: 190, category: "Bun-Tastic Burgers", type: "non-veg" },
        { name: "Tropical Pesto Chicken Burger", price: 220, category: "Bun-Tastic Burgers", type: "non-veg" },
        { name: "Tropical Tandoori Chicken Burger", price: 200, category: "Bun-Tastic Burgers", type: "non-veg" },
        { name: "Veg Burger (Panner)", price: 170, category: "Bun-Tastic Burgers", type: "veg" },
        { name: "Veg Slider Burger", price: 90, category: "Bun-Tastic Burgers", type: "veg" },

        { name: "Bbq Chicken Steak", price: 310, category: "Butcher's Best", type: "non-veg" },
        { name: "Beef Peppercorn Steak", price: 340, category: "Butcher's Best", type: "non-veg" },
        { name: "Beef Velvet Sauce Steak", price: 340, category: "Butcher's Best", type: "non-veg" },
        { name: "Fish Steak - BASA", price: 350, category: "Butcher's Best", type: "non-veg" },
        { name: "Fish Steak - KING", price: 350, category: "Butcher's Best", type: "non-veg" },
        { name: "Mediterranean BBQ Chicken Steak", price: 350, category: "Butcher's Best", type: "non-veg" },
        { name: "Panner Tandoori Steak", price: 340, category: "Butcher's Best", type: "veg" },
        { name: "Panner Velvet Sauce", price: 340, category: "Butcher's Best", type: "veg" },
        { name: "Peri Peri Chicken Steak", price: 350, category: "Butcher's Best", type: "non-veg" },
        { name: "Pesto Chicken Steak", price: 310, category: "Butcher's Best", type: "non-veg" },
        { name: "Tandoori Chicken Steak", price: 350, category: "Butcher's Best", type: "non-veg" },
        { name: "Velvet Sauce Chicken Steak", price: 350, category: "Butcher's Best", type: "non-veg" },

        { name: "Beef Wrap", price: 170, category: "Freshly Folded", type: "non-veg" },
        { name: "Chicken Chipotle Wrap", price: 160, category: "Freshly Folded", type: "non-veg" },
        { name: "Chicken Pesto Wrap", price: 160, category: "Freshly Folded", type: "non-veg" },
        { name: "Chicken Tandoori Wrap", price: 160, category: "Freshly Folded", type: "non-veg" },
        { name: "Veg Wrap", price: 140, category: "Freshly Folded", type: "veg" },

        { name: "Arabiata Chicken Pasta - Penne", price: 210, category: "Italian Indulgence", type: "non-veg" },
        { name: "Arabiata Chicken Pasta - Spaghetti", price: 240, category: "Italian Indulgence", type: "non-veg" },
        { name: "Black Garlic Chicken Penne Pasta", price: 280, category: "Italian Indulgence", type: "non-veg" },
        { name: "Classic Alfredo Chicken Pasta - Penne", price: 210, category: "Italian Indulgence", type: "non-veg" },
        { name: "Classic Alfredo Chicken Pasta - Spaghetti", price: 240, category: "Italian Indulgence", type: "non-veg" },
        { name: "Cloud Special Chicken Pasta - Penne", price: 230, category: "Italian Indulgence", type: "non-veg" },
        { name: "Cloud Special Chicken Pasta - Spaghetti", price: 260, category: "Italian Indulgence", type: "non-veg" },
        { name: "Creamy Spaghetti - NonVeg", price: 300, category: "Italian Indulgence", type: "non-veg" },
        { name: "Creamy Spaghetti - Veg", price: 300, category: "Italian Indulgence", type: "veg" },
        { name: "Pesto Pasta Chicken - Penne", price: 230, category: "Italian Indulgence", type: "non-veg" },
        { name: "Pesto Pasta Chicken - Spaghetti", price: 260, category: "Italian Indulgence", type: "non-veg" },
        { name: "Shrimp Pasta - Penne", price: 290, category: "Italian Indulgence", type: "non-veg" },
        { name: "Shrimp Pasta - Spaghetti", price: 320, category: "Italian Indulgence", type: "non-veg" },
        { name: "Special Pesto Pasta Chicken - Penne", price: 230, category: "Italian Indulgence", type: "non-veg" },
        { name: "Special Pesto Pasta Chicken - Spaghetti", price: 260, category: "Italian Indulgence", type: "non-veg" },
        { name: "Veg Pasta - Arabiata - Penne", price: 200, category: "Italian Indulgence", type: "veg" },
        { name: "Veg Pasta - Classic Alfredo - Penne", price: 200, category: "Italian Indulgence", type: "veg" },
        { name: "Veg Pasta - Cloud Special - Penne", price: 200, category: "Italian Indulgence", type: "veg" },
        { name: "Veg Pasta - Pesto - Penne", price: 200, category: "Italian Indulgence", type: "veg" },
        { name: "Veg Pasta - Special Pesto - Penne", price: 240, category: "Italian Indulgence", type: "veg" },
        { name: "Veg Pasta - Classic Alfredo - Spaghetti", price: 230, category: "Italian Indulgence", type: "veg" },
        { name: "Veg Pasta - Cloud Special - Spaghetti", price: 230, category: "Italian Indulgence", type: "veg" },
        { name: "Veg Pasta - Pesto - Spaghetti", price: 230, category: "Italian Indulgence", type: "veg" },
        { name: "Veg Pasta - Special Pesto - Spaghetti", price: 270, category: "Italian Indulgence", type: "veg" },
        { name: "Veg Pasta - Arabiata - Spaghetti", price: 230, category: "Italian Indulgence", type: "veg" },

        { name: "Chicken Fried Rice", price: 150, category: "Rice Harmony", type: "non-veg" },
        { name: "Cloud Club Power Bowl - Chicken", price: 200, category: "Rice Harmony", type: "non-veg" },
        { name: "Cloud Club Power Bowl - Veg", price: 170, category: "Rice Harmony", type: "veg" },
        { name: "Peri Peri Rice Bowl - Non-Veg", price: 150, category: "Rice Harmony", type: "non-veg" },
        { name: "Peri Peri Rice Bowl - Veg", price: 140, category: "Rice Harmony", type: "veg" },
        { name: "Plain Rice Bowl", price: 120, category: "Rice Harmony", type: "veg" },
        { name: "Tandoori Rice Bowl - Non-Veg", price: 160, category: "Rice Harmony", type: "non-veg" },
        { name: "Tandoori Rice Bowl - Veg", price: 150, category: "Rice Harmony", type: "veg" },

        { name: "Chicken Pesto Salad", price: 190, category: "Salad Symphony", type: "non-veg" },
        { name: "Classic Chicken Caesar Salad", price: 170, category: "Salad Symphony", type: "non-veg" },
        { name: "Cloud Special Chicken Salad", price: 170, category: "Salad Symphony", type: "non-veg" },
        { name: "Egg White Salad", price: 160, category: "Salad Symphony", type: "non-veg" },
        { name: "Grilled Beef Salad", price: 190, category: "Salad Symphony", type: "non-veg" },
        { name: "Paneer Pesto Salad", price: 170, category: "Salad Symphony", type: "veg" },
        { name: "Pesto Veg Salad", price: 160, category: "Salad Symphony", type: "veg" },
        { name: "Shrimp Classic Caesar Salad", price: 250, category: "Salad Symphony", type: "non-veg" },
        { name: "Sprout Fusion Salad", price: 160, category: "Salad Symphony", type: "non-veg" },
        { name: "Tuna Salad", price: 180, category: "Salad Symphony", type: "non-veg" },
        { name: "Veg Caesar Salad (Paneer)", price: 170, category: "Salad Symphony", type: "veg" },
        { name: "Veg Roasted Salad", price: 140, category: "Salad Symphony", type: "veg" },
        { name: "Veg Waldorf Salad", price: 170, category: "Salad Symphony", type: "veg" },

        { name: "Chicken Ham Club Sandwich", price: 170, category: "Toasty Treats", type: "non-veg" },
        { name: "Egg White Sandwich", price: 150, category: "Toasty Treats", type: "non-veg" },
        { name: "Grilled Chicken & Cheese Sandwich", price: 160, category: "Toasty Treats", type: "non-veg" },
        { name: "Regular Chicken Sandwich", price: 150, category: "Toasty Treats", type: "non-veg" },
        { name: "Tuna Club Sandwich", price: 170, category: "Toasty Treats", type: "non-veg" },
        { name: "Veg Club Sandwich", price: 150, category: "Toasty Treats", type: "veg" },
        
        { name: "Tomato Cream Soup", price: 130, category: "Warm Whispers", type: "veg" },
        { name: "Creamy Chicken Soup", price: 140, category: "Warm Whispers", type: "non-veg" },

        { name: "BBQ Chicken Popcorn", price: 180, category: "Nibbles & Bits", type: "non-veg" },
        { name: "Beef Loaded Fries", price: 220, category: "Nibbles & Bits", type: "non-veg" },
        { name: "Beef Omelette", price: 120, category: "Nibbles & Bits", type: "non-veg" },
        { name: "Cheese Egg Omelette", price: 130, category: "Nibbles & Bits", type: "non-veg" },
        { name: "Chicken Egg Omelette", price: 130, category: "Nibbles & Bits", type: "non-veg" },
        { name: "Chicken Loaded Fries", price: 210, category: "Nibbles & Bits", type: "non-veg" },
        { name: "Chicken Lollipop", price: 160, category: "Nibbles & Bits", type: "non-veg" },
        { name: "Chicken Nachos", price: 180, category: "Nibbles & Bits", type: "non-veg" },
        { name: "Chicken Nuggets", price: 90, category: "Nibbles & Bits", type: "non-veg" },
        { name: "Chicken Popcorn - Peri Peri", price: 210, category: "Nibbles & Bits", type: "non-veg" },
        { name: "Chicken Popcorn - Plain", price: 190, category: "Nibbles & Bits", type: "non-veg" },
        { name: "Chicken Sausage - BBQ", price: 170, category: "Nibbles & Bits", type: "non-veg" },
        { name: "Chicken Sausage - Plain", price: 170, category: "Nibbles & Bits", type: "non-veg" },
        { name: "Chicken Sausage - Tandoori", price: 170, category: "Nibbles & Bits", type: "non-veg" },
        { name: "Chicken Strips 5 Pcs - Peri Peri", price: 180, category: "Nibbles & Bits", type: "non-veg" },
        { name: "Chicken Strips 5 Pcs - Plain", price: 170, category: "Nibbles & Bits", type: "non-veg" },
        { name: "Cordon Bleu Chicken", price: 180, category: "Nibbles & Bits", type: "non-veg" },
        { name: "Fish Fingers - Peri Peri", price: 200, category: "Nibbles & Bits", type: "non-veg" },
        { name: "Fish Fingers", price: 180, category: "Nibbles & Bits", type: "non-veg" },
        { name: "French Fries - Herbal", price: 130, category: "Nibbles & Bits", type: "veg" },
        { name: "French Fries - Peri Peri", price: 120, category: "Nibbles & Bits", type: "veg" },
        { name: "French Fries - Salted", price: 100, category: "Nibbles & Bits", type: "veg" },
        { name: "Momo (Chicken)", price: 140, category: "Nibbles & Bits", type: "non-veg" },
        { name: "Mushroom Omelette", price: 120, category: "Nibbles & Bits", type: "non-veg" },
        { name: "Potato Wedges - Peri Peri", price: 140, category: "Nibbles & Bits", type: "veg" },
        { name: "Potato Wedges - Plain", price: 130, category: "Nibbles & Bits", type: "veg" },
        { name: "Scotch Egg", price: 160, category: "Nibbles & Bits", type: "non-veg" },
        { name: "Veg - Loaded Fries", price: 150, category: "Nibbles & Bits", type: "veg" },
        { name: "Wings + Fries", price: 200, category: "Nibbles & Bits", type: "non-veg" },

        { name: "Black Current Chillers", price: 90, category: "Icy Sips", type: "veg" },
        { name: "Green Apple Chillers", price: 90, category: "Icy Sips", type: "veg" },
        { name: "Guava Chillers", price: 90, category: "Icy Sips", type: "veg" },
        { name: "Lychee Chillers", price: 90, category: "Icy Sips", type: "veg" },
        { name: "Mango Chillers", price: 90, category: "Icy Sips", type: "veg" },
        { name: "Peach Chillers", price: 90, category: "Icy Sips", type: "veg" },
        { name: "Watermelon Chillers", price: 90, category: "Icy Sips", type: "veg" },

        { name: "Citrus Blue Glacier Mojito", price: 125, category: "Mojito Magic", type: "veg" },
        { name: "Deep Blue Mojito", price: 125, category: "Mojito Magic", type: "veg" },
        { name: "Frizzante Lemone Masala", price: 70, category: "Mojito Magic", type: "veg" },
        { name: "Green Apple Mojito", price: 125, category: "Mojito Magic", type: "veg" },
        { name: "Grenadine Mojito", price: 125, category: "Mojito Magic", type: "veg" },
        { name: "Lavender Mojito", price: 125, category: "Mojito Magic", type: "veg" },
        { name: "Lemon Mojito", price: 125, category: "Mojito Magic", type: "veg" },
        { name: "Lychee Mojito", price: 125, category: "Mojito Magic", type: "veg" },
        { name: "Mango Mojito", price: 120, category: "Mojito Magic", type: "veg" },
        { name: "Passion Fruit Mojito", price: 125, category: "Mojito Magic", type: "veg" },
        { name: "Peach Mojito", price: 125, category: "Mojito Magic", type: "veg" },
        { name: "Watermelon Mojito", price: 125, category: "Mojito Magic", type: "veg" },

        { name: "Apple Juice", price: 120, category: "Nature's Nectar", type: "veg" },
        { name: "Carrot & Lemon Juice", price: 80, category: "Nature's Nectar", type: "veg" },
        { name: "Carrot Juice", price: 80, category: "Nature's Nectar", type: "veg" },
        { name: "Celery, Apple & Ginger Juice", price: 110, category: "Nature's Nectar", type: "veg" },
        { name: "Cucumber & Carrot Juice", price: 90, category: "Nature's Nectar", type: "veg" },
        { name: "Cucumber, Lemon & Mint Juice", price: 70, category: "Nature's Nectar", type: "veg" },
        { name: "Fresh Lime", price: 40, category: "Nature's Nectar", type: "veg" },
        { name: "Lemon & Celery Juice", price: 50, category: "Nature's Nectar", type: "veg" },
        { name: "Mango Juice", price: 80, category: "Nature's Nectar", type: "veg" },
        { name: "Mosambi Juice", price: 90, category: "Nature's Nectar", type: "veg" },
        { name: "Muskmelon Juice", price: 80, category: "Nature's Nectar", type: "veg" },
        { name: "Orange Juice", price: 90, category: "Nature's Nectar", type: "veg" },
        { name: "Papaya Juice", price: 70, category: "Nature's Nectar", type: "veg" },
        { name: "Pineapple & Carrot Juice", price: 90, category: "Nature's Nectar", type: "veg" },
        { name: "Pineapple Juice", price: 90, category: "Nature's Nectar", type: "veg" },
        { name: "Pomegranate Juice", price: 100, category: "Nature's Nectar", type: "veg" },
        { name: "Watermelon Juice", price: 80, category: "Nature's Nectar", type: "veg" },
        { name: "Zesty Pineapple Breeze", price: 90, category: "Nature's Nectar", type: "veg" },

        { name: "Arabian Milkshake", price: 135, category: "Whipped Wonders", type: "veg" },
        { name: "Avocado Mango Milkshake", price: 150, category: "Whipped Wonders", type: "veg" },
        { name: "Avocado Banana Almonds", price: 150, category: "Whipped Wonders", type: "veg" },
        { name: "Avocado Milkshake", price: 140, category: "Whipped Wonders", type: "veg" },
        { name: "Black Current Milkshake", price: 125, category: "Whipped Wonders", type: "veg" },
        { name: "Black Grape Milkshake", price: 125, category: "Whipped Wonders", type: "veg" },
        { name: "Blue Berry Milkshake", price: 140, category: "Whipped Wonders", type: "veg" },
        { name: "Blue Milkshake", price: 140, category: "Whipped Wonders", type: "veg" },
        { name: "Butter Peanut", price: 130, category: "Whipped Wonders", type: "veg" },
        { name: "Caramel Milkshake", price: 125, category: "Whipped Wonders", type: "veg" },
        { name: "Chikku Shake", price: 130, category: "Whipped Wonders", type: "veg" },
        { name: "ChocoButter Peanut Shake", price: 140, category: "Whipped Wonders", type: "veg" },
        { name: "Chocolate Milkshake", price: 125, category: "Whipped Wonders", type: "veg" },
        { name: "Dry Fruit Milkshake", price: 135, category: "Whipped Wonders", type: "veg" },
        { name: "Lotus Biscoff Milkshake", price: 140, category: "Whipped Wonders", type: "veg" },
        { name: "Lychee Milkshake", price: 125, category: "Whipped Wonders", type: "veg" },
        { name: "Mango Milkshake", price: 125, category: "Whipped Wonders", type: "veg" },
        { name: "Mango Mint Milkshake", price: 135, category: "Whipped Wonders", type: "veg" },
        { name: "Milo Shake", price: 150, category: "Whipped Wonders", type: "veg" },
        { name: "Oreo Milkshake", price: 125, category: "Whipped Wonders", type: "veg" },
        { name: "Roasted Dry Fruit Shake", price: 160, category: "Whipped Wonders", type: "veg" },
        { name: "Strawberry & Mango Shake", price: 135, category: "Whipped Wonders", type: "veg" },
        { name: "Strawberry Milkshake", price: 125, category: "Whipped Wonders", type: "veg" },
        { name: "Tender Coconut Milkshake", price: 135, category: "Whipped Wonders", type: "veg" },
        { name: "Vanilla Milkshake", price: 115, category: "Whipped Wonders", type: "veg" },

        { name: "Lemon Ice Tea", price: 125, category: "Frosted Leaf", type: "veg" },
        { name: "Lychee Ice Tea", price: 125, category: "Frosted Leaf", type: "veg" },
        { name: "Passion Fruit Ice Tea", price: 125, category: "Frosted Leaf", type: "veg" },
        { name: "Peach Ice Tea", price: 125, category: "Frosted Leaf", type: "veg" },

        { name: "Garlic Bread (4)", price: 50, category: "ADD-ON", type: "veg" },
        { name: "Garlic Sauce", price: 20, category: "ADD-ON", type: "veg" },
        { name: "Hash Brown", price: 20, category: "ADD-ON", type: "veg" },
        { name: "Hummus", price: 50, category: "ADD-ON", type: "veg" }
    ];

    let cart = {};
    let activeCoupon = null; // Track applied coupon

    /* --- FILTER STATES --- */
    let currentCategory = 'All';
    let currentSearch = '';
    let currentSort = 'default';
    let currentType = 'all'; // veg, non-veg
    let currentIngredient = 'all'; // Chicken, Beef, Fish, Paneer
    let isUnder200 = false;

    /* --- FILTER FUNCTIONS --- */
    function setCategoryFilter(cat, btn) {
        document.querySelectorAll('.filter-item').forEach(b => b.classList.remove('active'));
        if(btn) btn.classList.add('active');
        currentCategory = cat;
        renderMenu();
        
        // Mobile specific: If we are on mobile, scroll to top of menu
        if(window.innerWidth <= 1000) {
            document.querySelector('.main-content').scrollTop = 0;
        }
    }

    function updateSearch() {
        currentSearch = document.getElementById('search-input').value;
        renderMenu();
    }

    function setSort(val) {
        currentSort = val;
        renderMenu();
    }

    function setType(val) {
        currentType = val;
        renderMenu();
    }

    function setIngredient(val) {
        currentIngredient = val;
        renderMenu();
    }

    function toggleUnder200(btn) {
        isUnder200 = !isUnder200;
        if(isUnder200) btn.classList.add('active');
        else btn.classList.remove('active');
        renderMenu();
    }

    /* --- NEW FUNCTION TO COPY PROMO CODES --- */
    function copyCode(code) {
        const couponInput = document.getElementById('coupon-input');
        const couponBtn = document.getElementById('coupon-apply-btn');
        
        couponInput.value = code;
        
        // --- Added: Enable Button when copy happens ---
        couponBtn.disabled = false;
        
        // If on mobile, open the cart so they can see it was applied
        if(window.innerWidth <= 1000) {
            toggleCartPage();
        }
        
        // Auto-scroll to coupon section in cart
        couponInput.scrollIntoView({behavior: "smooth"});
        
        // Visual feedback
        couponInput.style.borderColor = "var(--primary)";
        setTimeout(() => couponInput.style.borderColor = "#ddd", 500);
    }

    /* --- MAIN RENDER FUNCTION --- */
    function renderMenu() {
        const root = document.getElementById('menu-root');
        root.innerHTML = '';

        let filteredItems = menuData.filter(item => {
            if (currentCategory !== 'All' && item.category !== currentCategory) return false;
            if (currentSearch && !item.name.toLowerCase().includes(currentSearch.toLowerCase())) return false;
            if (currentType === 'veg' && item.type !== 'veg') return false;
            if (currentType === 'non-veg' && item.type !== 'non-veg') return false;
            if (isUnder200 && item.price >= 200) return false;
            if (currentIngredient !== 'all') {
                const nameLower = item.name.toLowerCase();
                const ingLower = currentIngredient.toLowerCase();
                if(ingLower === 'panner' || ingLower === 'paneer') {
                    if(!nameLower.includes('panner') && !nameLower.includes('paneer')) return false;
                } else {
                    if(!nameLower.includes(ingLower)) return false;
                }
            }
            return true;
        });

        if (currentSort === 'low-high') {
            filteredItems.sort((a, b) => a.price - b.price);
        } else if (currentSort === 'high-low') {
            filteredItems.sort((a, b) => b.price - a.price);
        }

        if (filteredItems.length === 0) {
            root.innerHTML = '<div style="grid-column: 1/-1; text-align:center; color:#999; padding: 20px;">No items found matching your filters.</div>';
            return;
        }

        filteredItems.forEach((item, index) => {
            const originalIndex = menuData.indexOf(item);
            const card = document.createElement('div');
            card.className = `food-card ${item.type}`;
            card.id = `card-${originalIndex}`;
            
            const emojiStr = item.type === 'veg' ? vegIcon : nonVegIcon;
            
            let optionsHtml = '';
            let hasOptions = false;
            const cheeseCats = ["Bun-Tastic Burgers", "Italian Indulgence", "Freshly Folded", "Toasty Treats"];
            if (cheeseCats.includes(item.category)) {
                hasOptions = true;
                optionsHtml += `<label class="option-label"><input type="checkbox" data-name="Extra Cheese" data-price="15"> Extra Cheese (+${rupeeSign}15)</label>`;
            }
            if (item.category === "Italian Indulgence") {
                hasOptions = true;
                optionsHtml += `<label class="option-label"><input type="checkbox" data-name="Garlic Bread" data-price="40"> Add Garlic Bread (+${rupeeSign}40)</label>`;
            }
            if (item.category === "Butcher's Best") {
                hasOptions = true;
                optionsHtml += `<label class="option-label"><input type="checkbox" data-name="Extra Hashbrown" data-price="40"> Extra Hashbrown (+${rupeeSign}40)</label>`;
                
                // --- NEW ADDITIONS FOR BUTCHER'S BEST ---
                optionsHtml += `<label class="option-label"><input type="checkbox" data-name="Tossed Rice" data-price="40"> Tossed Rice (+${rupeeSign}40)</label>`;
                optionsHtml += `<label class="option-label"><input type="checkbox" data-name="Sorted / Boiled Vegges" data-price="40"> Sorted / Boiled Vegges (+${rupeeSign}40)</label>`;
            }
            if (item.category === "Whipped Wonders") {
                hasOptions = true;
                optionsHtml += `<label class="option-label"><input type="checkbox" data-name="Extra Ice Cream (Thick Shake)" data-price="30"> Extra Ice Cream (+${rupeeSign}30)</label>`;
            }
            if (item.category !== "ADD-ON") {
                hasOptions = true;
                optionsHtml += `<input type="text" class="note-input" placeholder="Special Note (e.g. Spicy)">`;
            }
            if (hasOptions) optionsHtml = `<div class="options-area">${optionsHtml}</div>`;

            card.innerHTML = `
                <div class="card-top">
                    <div class="food-title">
                        <span class="type-emoji">${emojiStr}</span>
                        ${item.name}
                    </div>
                    <div class="food-meta">${item.category}</div>
                    ${optionsHtml}
                </div>
                <div class="price-row">
                    <div class="price">${rupeeSign}${item.price}</div>
                    <button class="add-btn-mini" onclick="addItemFromCard(${originalIndex})">
                        ADD <i class="fas fa-plus"></i>
                    </button>
                </div>
            `;
            root.appendChild(card);
        });
    }

    /* --- CART FUNCTIONS --- */
    
    function addItemFromCard(index) {
        const item = menuData[index];
        const card = document.getElementById(`card-${index}`);
        
        const checkboxes = card.querySelectorAll('input[type="checkbox"]:checked');
        let finalPrice = item.price;
        let modifiers = [];
        
        checkboxes.forEach(cb => {
            finalPrice += parseInt(cb.dataset.price);
            modifiers.push(cb.dataset.name);
        });

        const noteInput = card.querySelector('.note-input');
        const noteText = noteInput ? noteInput.value.trim() : '';

        let displayName = item.name;
        if(modifiers.length > 0) displayName += ` [${modifiers.join(', ')}]`;
        if(noteText) displayName += ` (Note: ${noteText})`;

        addToCart(displayName, finalPrice, item.type, item.category);
        
        checkboxes.forEach(cb => cb.checked = false);
        if(noteInput) noteInput.value = '';
    }

    function addToCart(name, price, type, category) {
        if (cart[name]) {
            cart[name].qty++;
        } else {
            cart[name] = { price: price, qty: 1, type: type, category: category };
        }
        renderCart();
        const btn = document.querySelector('.mobile-cart-btn');
        btn.style.transform = "scale(1.2)";
        setTimeout(() => btn.style.transform = "scale(1)", 200);
    }

    function updateQty(name, change) {
        if (cart[name]) {
            cart[name].qty += change;
            if (cart[name].qty <= 0) {
                delete cart[name];
            }
            renderCart();
        }
    }

    /* --- UPDATED REQUIREMENT CHECKER (STRICT QUANTITIES) --- */
    function checkComboRequirements(codeToCheck) {
        
        // 1. Logic for CLOUD15 (Strictly 1 Burger + 1 Fries + 1 Drink)
        if (codeToCheck === 'CLOUD15') {
            let burgerQty = 0;
            let friesQty = 0;
            let drinkQty = 0;

            for (let key in cart) {
                const item = cart[key];
                
                // Count Burgers
                if (item.category === 'Bun-Tastic Burgers') {
                    burgerQty += item.qty;
                }
                // Count Fries (Matches "French Fries - Salted", "Peri Peri", etc.)
                if (key.includes('French Fries')) {
                    friesQty += item.qty;
                }
                // Count Drinks
                if (item.category === 'Icy Sips') {
                    drinkQty += item.qty;
                }
            }

            // STRICT CHECK: Must be exactly 1 of each
            return burgerQty === 1 && friesQty === 1 && drinkQty === 1;
        }

        // 2. Logic for STEAK13 (Strictly 1 Butcher's Best + 1 Whipped Wonder)
        if (codeToCheck === 'STEAK13') {
            let steakQty = 0;
            let whippedQty = 0;

            for (let key in cart) {
                const item = cart[key];
                
                if (item.category === "Butcher's Best") {
                    steakQty += item.qty;
                }
                if (item.category === "Whipped Wonders") {
                    whippedQty += item.qty;
                }
            }
            
            // STRICT CHECK: Must be exactly 1 of each
            return steakQty === 1 && whippedQty === 1;
        }

        // 3. Logic for QUICK20 (STRICTLY 1 Wrap + 1 Side)
        if (codeToCheck === 'QUICK20') {
            let wrapQty = 0;
            let sideQty = 0;

            for (let key in cart) {
                const item = cart[key];
                
                if (item.category === "Freshly Folded") {
                    wrapQty += item.qty;
                }
                if (key.includes("French Fries") || key === "Chicken Nuggets") {
                    sideQty += item.qty;
                }
            }
            
            return wrapQty === 1 && sideQty === 1;
        }

        // 4. Logic for FEAST14 (Strictly 2 Burgers, 2 Mains, 1 Loaded Fries, 4 Drinks)
        if (codeToCheck === 'FEAST14') {
            let burgerQty = 0;
            let mainCourseQty = 0; // Italian Indulgence OR Rice Harmony
            let loadedFriesQty = 0; // Loaded fries check
            let drinkQty = 0; // Nature's Nectar

            for (let key in cart) {
                const item = cart[key];
                
                // 1. Burgers
                if (item.category === "Bun-Tastic Burgers") {
                    burgerQty += item.qty;
                }

                // 2. Main Course (Italian OR Rice)
                if (item.category === "Italian Indulgence" || item.category === "Rice Harmony") {
                    mainCourseQty += item.qty;
                }

                // 3. Loaded Fries (Name check)
                if (key.includes("Loaded Fries")) {
                    loadedFriesQty += item.qty;
                }

                // 4. Drinks
                if (item.category === "Nature's Nectar") {
                    drinkQty += item.qty;
                }
            }

            // STRICT CHECK
            return burgerQty === 2 && mainCourseQty === 2 && loadedFriesQty === 1 && drinkQty === 4;
        }

        return false;
    }

    /* --- UPDATED APPLY COUPON FUNCTION --- */
    function applyCoupon() {
        const codeInput = document.getElementById('coupon-input');
        const msgBox = document.getElementById('coupon-msg');
        const code = codeInput.value.trim().toUpperCase();

        // Check for CLOUD15
        if (code === 'CLOUD15') {
            if (checkComboRequirements('CLOUD15')) {
                activeCoupon = 'CLOUD15';
                msgBox.innerText = "Coupon Applied! 15% Off";
                msgBox.className = "coupon-msg success";
            } else {
                msgBox.innerText = "Strictly: Exactly 1 Burger, 1 Fries & 1 Icy Sip";
                msgBox.className = "coupon-msg error";
                activeCoupon = null;
            }
            renderCart();
            return;
        }

        // Check for STEAK13
        if (code === 'STEAK13') {
            if (checkComboRequirements('STEAK13')) {
                activeCoupon = 'STEAK13';
                msgBox.innerText = "Steak & Sip Supreme Applied! 13% Off";
                msgBox.className = "coupon-msg success";
            } else {
                msgBox.innerText = "Strictly: Exactly 1 Butcher's Best & 1 Whipped Wonder";
                msgBox.className = "coupon-msg error";
                activeCoupon = null;
            }
            renderCart();
            return;
        }

        // Check for QUICK20
        if (code === 'QUICK20') {
            if (checkComboRequirements('QUICK20')) {
                activeCoupon = 'QUICK20';
                msgBox.innerText = "Quick Bite Duo Applied! 20% Off";
                msgBox.className = "coupon-msg success";
            } else {
                msgBox.innerText = "Strictly: Exactly 1 Wrap & Exactly 1 Side (Fries/Nuggets)";
                msgBox.className = "coupon-msg error";
                activeCoupon = null;
            }
            renderCart();
            return;
        }

        // Check for FEAST14
        if (code === 'FEAST14') {
            if (checkComboRequirements('FEAST14')) {
                activeCoupon = 'FEAST14';
                msgBox.innerText = "The Cloud Feast for 4 Applied! 14% Off";
                msgBox.className = "coupon-msg success";
            } else {
                msgBox.innerText = "Strictly: 2 Burgers, 2 Pasta/Rice, 1 Loaded Fries & 4 Nature's Nectar";
                msgBox.className = "coupon-msg error";
                activeCoupon = null;
            }
            renderCart();
            return;
        }

        // If Code is invalid
        msgBox.innerText = "Invalid Coupon Code";
        msgBox.className = "coupon-msg error";
        activeCoupon = null;
        renderCart();
    }

    /* --- UPDATED RENDER CART --- */
    function renderCart() {
        const list = document.getElementById('cart-items-list');
        list.innerHTML = '';
        
        let subTotal = 0;
        let packingTotal = 0;
        let totalCount = 0;
        let hasItems = false;
        const fiveRsCats = ["Bun-Tastic Burgers", "Freshly Folded", "Toasty Treats"];

        for (let key in cart) {
            hasItems = true;
            const item = cart[key];
            const itemTotal = item.price * item.qty;
            subTotal += itemTotal;
            totalCount += item.qty;
            
            let chargePerItem = 0;
            if (item.category === 'ADD-ON') {
                if (key.startsWith("Hummus")) chargePerItem = 7;
                else chargePerItem = 5;
            } else if (fiveRsCats.includes(item.category)) {
                chargePerItem = 5;
            } else {
                chargePerItem = 10;
            }
            packingTotal += (chargePerItem * item.qty);

            // --- NEW: Add extra packing charge for Butcher's Best Add-ons ---
            if (key.includes("Tossed Rice")) {
                packingTotal += (7 * item.qty);
            }
            if (key.includes("Sorted / Boiled Vegges")) {
                packingTotal += (7 * item.qty);
            }
            // -------------------------------------------------------------

            list.innerHTML += `
                <div class="cart-item">
                    <div class="cart-details">
                        <span class="cart-name">${key}</span>
                        <span class="cart-price">${rupeeSign}${item.price}</span>
                    </div>
                    <div class="qty-wrapper">
                        <button class="qty-btn" onclick="updateQty('${key}', -1)">−</button>
                        <span>${item.qty}</span>
                        <button class="qty-btn" onclick="updateQty('${key}', 1)">+</button>
                    </div>
                </div>
            `;
        }

        if(!hasItems) list.innerHTML = `<div style="text-align: center; color: #ccc; margin-top: 50px;">Cart is empty</div>`;

        // --- UPDATED DISCOUNT LOGIC ---
        let discountVal = 0;
        const discountRow = document.getElementById('discount-row');
        const msgBox = document.getElementById('coupon-msg');
        let discountText = "";

        if (activeCoupon === 'CLOUD15') {
            if (checkComboRequirements('CLOUD15')) {
                discountVal = Math.round(subTotal * 0.15); // 15% Logic
                discountText = "Coupon (15% OFF)";
            } else {
                activeCoupon = null;
                msgBox.innerText = "Coupon removed - Requirements missing";
                msgBox.className = "coupon-msg error";
            }
        } 
        else if (activeCoupon === 'STEAK13') {
            if (checkComboRequirements('STEAK13')) {
                discountVal = Math.round(subTotal * 0.13); // 13% Logic
                discountText = "Steak & Sip (13% OFF)";
            } else {
                activeCoupon = null;
                msgBox.innerText = "Coupon removed - Requirements missing";
                msgBox.className = "coupon-msg error";
            }
        }
        else if (activeCoupon === 'QUICK20') {
            if (checkComboRequirements('QUICK20')) {
                discountVal = Math.round(subTotal * 0.20); // 20% Logic
                discountText = "Quick Bite (20% OFF)";
            } else {
                activeCoupon = null;
                msgBox.innerText = "Coupon removed - Strict limit exceeded";
                msgBox.className = "coupon-msg error";
            }
        }
        else if (activeCoupon === 'FEAST14') {
            if (checkComboRequirements('FEAST14')) {
                discountVal = Math.round(subTotal * 0.14); // 14% Logic
                discountText = "Cloud Feast (14% OFF)";
            } else {
                activeCoupon = null;
                msgBox.innerText = "Coupon removed - Strict limit exceeded";
                msgBox.className = "coupon-msg error";
            }
        }

        // Show/Hide Discount Row
        if (discountVal > 0) {
            discountRow.style.display = 'flex';
            discountRow.querySelector('span:first-child').innerText = discountText;
            document.getElementById('discount-total').innerText = `- ${rupeeSign}${discountVal}`;
        } else {
            discountRow.style.display = 'none';
        }

        let grandTotal = (subTotal - discountVal) + packingTotal;

        document.getElementById('sub-total').innerText = rupeeSign + subTotal;
        document.getElementById('packing-total').innerText = rupeeSign + packingTotal;
        document.getElementById('grand-total').innerText = rupeeSign + grandTotal;
        document.getElementById('mobile-count').innerText = `(${totalCount})`;

        const checkoutBtn = document.getElementById('main-checkout-btn');
        if(!hasItems) {
            checkoutBtn.innerText = "Cart Empty";
            checkoutBtn.disabled = true;
        } else if ((subTotal - discountVal) < MIN_ORDER_VAL) {
            checkoutBtn.innerText = `Min Order ${rupeeSign}${MIN_ORDER_VAL}`;
            checkoutBtn.disabled = true;
        } else {
            checkoutBtn.innerText = "Confirm Order";
            checkoutBtn.disabled = false;
        }
    }

    /* --- MOBILE & MODAL UTILS --- */
    function toggleCartPage() {
        const sidebar = document.getElementById('cart-sidebar');
        sidebar.classList.toggle('active');
    }

    function openCheckoutModal() {
        document.getElementById('checkout-modal').style.display = 'flex';
        toggleOrderFields();
    }
    function closeCheckoutModal() {
        document.getElementById('checkout-modal').style.display = 'none';
    }
    function toggleOrderFields() {
        const type = document.querySelector('input[name="orderType"]:checked').value;
        const addrGroup = document.getElementById('address-group');
        const timeLabel = document.getElementById('time-label');
        if(type === 'Pickup') {
            addrGroup.style.display = 'none';
            timeLabel.innerText = "Preferred Pickup Time";
        } else {
            addrGroup.style.display = 'block';
            timeLabel.innerText = "Preferred Delivery Time";
        }
    }

    /* --- NEW: CHECK STORE STATUS --- */
    function checkStoreStatus(orderType) {
        const now = new Date();
        const hour = now.getHours(); // 0-23

        // Delivery: 2:00 PM (14:00) to 3:00 AM (03:00)
        // Open if: Hour >= 14 OR Hour < 3
        if (orderType === 'Delivery') {
            if (hour >= 14 || hour < 3) return { isOpen: true };
            return { isOpen: false, msg: "Delivery is only available from 2:00 PM to 3:00 AM." };
        }

        // Pickup: 3:00 PM (15:00) to 3:00 AM (03:00)
        // Open if: Hour >= 15 OR Hour < 3
        if (orderType === 'Pickup') {
            if (hour >= 15 || hour < 3) return { isOpen: true };
            return { isOpen: false, msg: "Pickup/Dine-In is only available from 3:00 PM to 3:00 AM." };
        }
        return { isOpen: true }; // Fallback
    }

    /* --- UPDATED FINALIZATION (WhatsApp) --- */
    function finalizeOrder() {
        const type = document.querySelector('input[name="orderType"]:checked').value;
        
        // --- NEW: Time Check Logic ---
        const status = checkStoreStatus(type);
        if (!status.isOpen) {
            alert("Store Closed!\n" + status.msg);
            return; // Stop the order
        }
        // -----------------------------

        const name = document.getElementById('c-name').value.trim();
        const phone = document.getElementById('c-phone').value.trim();
        const email = document.getElementById('c-email').value.trim();
        const address = document.getElementById('c-address').value.trim();
        const time = document.getElementById('c-time').value;
        const instruction = document.getElementById('c-instruction').value.trim();

        if(!name || !phone || !email || !time) {
            alert("Please fill in Name, Phone, Email and Time.");
            return;
        }
        if(type === 'Delivery' && !address) {
            alert("Please fill in the Delivery Address.");
            return;
        }

        const phoneRegex = /^[0-9]{10,12}$/;
        if (!phoneRegex.test(phone)) {
            alert("Strict Policy: Phone number must be 10-12 digits (numbers only).");
            return; 
        }

        if (!email.includes('@')) {
            alert("Strict Policy: Invalid Email. Must contain '@'.");
            return; 
        }

        const orderId = Math.floor(100000 + Math.random() * 900000);
        const now = new Date();
        const timeString = now.toLocaleString('en-IN', { dateStyle: 'medium', timeStyle: 'short' });

        let msg = `*New Order @ Café Cloud Club*\n`; 
        msg += `*Type:* ${type.toUpperCase()}\n`;
        msg += `*Time Placed:* ${timeString}\n`;
        msg += `*Order ID:* ${orderId}\n`;
        msg += `---------------------------\n`;
        msg += `*Name:* ${name}\n`;
        msg += `*Phone:* ${phone}\n`;
        msg += `*Email:* ${email}\n`;
        msg += `*Preferred Time:* ${time}\n`;
        
        if(type === 'Delivery') msg += `*Address:* ${address}\n`;
        if(instruction) msg += `*Note:* ${instruction}\n`;
        
        msg += `---------------------------\n`;
        msg += `*ITEMS:*\n`;

        let subTotal = 0;
        let packingTotal = 0;
        const fiveRsCats = ["Bun-Tastic Burgers", "Freshly Folded", "Toasty Treats"];

        for(let key in cart) {
            let item = cart[key];
            let lineTotal = item.price * item.qty;
            subTotal += lineTotal;
            
            let chargePerItem = 0;
            if (item.category === 'ADD-ON') {
                if (key.startsWith("Hummus")) chargePerItem = 7;
                else chargePerItem = 5;
            } else if (fiveRsCats.includes(item.category)) {
                chargePerItem = 5;
            } else {
                chargePerItem = 10;
            }
            packingTotal += (chargePerItem * item.qty);

            // --- NEW: Add extra packing for WhatsApp calc ---
            if (key.includes("Tossed Rice")) {
                packingTotal += (7 * item.qty);
            }
            if (key.includes("Sorted / Boiled Vegges")) {
                packingTotal += (7 * item.qty);
            }
            
            let typeLabel = item.type === 'veg' ? '(Veg)' : '(Non-Veg)';
            msg += `• ${key} ${typeLabel} x ${item.qty} = Rs. ${lineTotal}\n`;
        }
        
        // --- UPDATED CALCULATE DISCOUNT FOR WHATSAPP ---
        let discountVal = 0;
        let couponName = "";

        if (activeCoupon === 'CLOUD15' && checkComboRequirements('CLOUD15')) {
            discountVal = Math.round(subTotal * 0.15);
            couponName = "CLOUD15";
        }
        else if (activeCoupon === 'STEAK13' && checkComboRequirements('STEAK13')) {
            discountVal = Math.round(subTotal * 0.13);
            couponName = "STEAK13";
        }
        else if (activeCoupon === 'QUICK20' && checkComboRequirements('QUICK20')) {
            discountVal = Math.round(subTotal * 0.20);
            couponName = "QUICK20";
        }
        else if (activeCoupon === 'FEAST14' && checkComboRequirements('FEAST14')) {
            discountVal = Math.round(subTotal * 0.14);
            couponName = "FEAST14";
        }

        let grandTotal = (subTotal - discountVal) + packingTotal;

        msg += `---------------------------\n`;
        msg += `Sub Total: Rs. ${subTotal}\n`;
        
        if (discountVal > 0) {
            msg += `*Coupon (${couponName}): -Rs. ${discountVal}*\n`;
        }

        msg += `Packing Charges: Rs. ${packingTotal}\n`;
        msg += `*TOTAL BILL: Rs. ${grandTotal}*\n`;
        
        if(type === 'Delivery') msg += `\n_Note: Delivery charges will be calculated by the agent._`;

        const encodedMsg = encodeURIComponent(msg);
        const finalUrl = `https://wa.me/${whatsappNumber}?text=${encodedMsg}`;

        document.getElementById('main-dashboard').style.display = 'none';
        document.getElementById('checkout-modal').style.display = 'none';
        document.getElementById('success-view').style.display = 'flex';
        document.getElementById('customer-name-display').innerText = name;
        
        document.getElementById('send-wa-btn').onclick = function() {
            window.open(finalUrl, '_blank');
        };
    }

    document.addEventListener('DOMContentLoaded', () => {
        renderMenu();
        
        /* --- NEW BUTTON LISTENER --- */
        const cInput = document.getElementById('coupon-input');
        const cBtn = document.getElementById('coupon-apply-btn');
        
        cInput.addEventListener('input', function() {
             // If input has text, enable button. If empty, disable.
             if(this.value.trim().length > 0) {
                 cBtn.disabled = false;
             } else {
                 cBtn.disabled = true;
             }
        });
    });

</script>
</body>
</html>