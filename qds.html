<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Caf√© Cloud - TV Display</title>
    <style>
        /* TV OPTIMIZED CSS */
        body { 
            margin: 0; background: #111; color: #fff; 
            font-family: 'Segoe UI', sans-serif; height: 100vh; 
            display: flex; overflow: hidden; 
        }
        
        /* COLUMNS */
        .column { flex: 1; padding: 0; display: flex; flex-direction: column; }
        .column:first-child { border-right: 4px solid #333; }
        
        /* HEADERS */
        .header { 
            padding: 25px; text-align: center; 
            font-size: 3.5vw; font-weight: 800; text-transform: uppercase; 
            background: #1a1a1a; box-shadow: 0 4px 15px rgba(0,0,0,0.5);
            z-index: 10;
        }
        
        /* ORDER LIST */
        .order-list { 
            padding: 30px; flex: 1; overflow: hidden; 
            display: grid; grid-template-columns: 1fr 1fr; /* 2 numbers per row */
            gap: 25px; align-content: start; 
        }

        /* CARD DESIGN */
        .order-card {
            font-size: 7vw; font-weight: 900; 
            text-align: center; padding: 15px 0;
            border-radius: 12px; background: #222;
            animation: popIn 0.3s ease-out;
        }

        /* PREPARING COLORS (Yellow) */
        .preparing .header { color: #facc15; border-bottom: 4px solid #facc15; }
        .preparing .order-card { color: #facc15; border: 2px solid #facc15; }

        /* READY COLORS (Green) */
        .ready .header { color: #4ade80; border-bottom: 4px solid #4ade80; }
        .ready .order-card { 
            background: #4ade80; color: #000; 
            box-shadow: 0 0 30px rgba(74, 222, 128, 0.3);
            animation: pulse 2s infinite;
        }

        @keyframes popIn { from { transform: scale(0.8); opacity: 0; } to { transform: scale(1); opacity: 1; } }
        @keyframes pulse { 0% { opacity: 1; } 50% { opacity: 0.8; } 100% { opacity: 1; } }
    </style>
</head>
<body>

    <div class="column preparing">
        <div class="header">Preparing</div>
        <div class="order-list" id="prep-list"></div>
    </div>

    <div class="column ready">
        <div class="header">Ready to Collect</div>
        <div class="order-list" id="ready-list"></div>
    </div>

    <audio id="bell" src="https://assets.mixkit.co/active_storage/sfx/2869/2869-preview.mp3"></audio>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

        // --- REPLACE THIS WITH YOUR NEW KEYS ---
        const firebaseConfig = {
            apiKey: "AIzaSyBEdTFc2eMatP-7c1uqX5CD5dMW6jYLu84",
            authDomain: "cafe-cloud-qds.firebaseapp.com",
            databaseURL: "https://cafe-cloud-qds-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "cafe-cloud-qds",
            storageBucket: "cafe-cloud-qds.firebasestorage.app",
            messagingSenderId: "277516157848",
            appId: "1:277516157848:web:1c5220480ac47cb4e961ed"
        };
        // --------------------------------------

        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);
        const bell = document.getElementById('bell');
        let knownReadyOrders = new Set(); // Track orders to play sound only once

        onValue(ref(db, 'orders'), (snapshot) => {
            const prepList = document.getElementById('prep-list');
            const readyList = document.getElementById('ready-list');
            
            prepList.innerHTML = '';
            readyList.innerHTML = '';
            
            const data = snapshot.val();
            if (!data) return;

            Object.values(data).forEach(order => {
                const card = document.createElement('div');
                card.className = 'order-card';
                card.innerText = `#${order.orderId}`; // Specific var from your files
                
                // LOGIC MATCHING YOUR UPLOADED FILES
                if (order.status === 'cooking') {
                    prepList.appendChild(card);
                } 
                else if (order.status === 'done') {
                    readyList.appendChild(card);
                    
                    // Play sound if this is a NEW ready order
                    if (!knownReadyOrders.has(order.orderId)) {
                        bell.play().catch(() => {}); // Catch error if user hasn't interacted yet
                        knownReadyOrders.add(order.orderId);
                    }
                }
            });
        });
        
        // Quick interaction to enable audio on TV
        document.body.addEventListener('click', () => { bell.play(); });
    </script>
</body>
</html>
