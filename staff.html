<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KITCHEN DISPLAY - Caf√© Cloud Club</title>
    <meta http-equiv="refresh" content="30">
    <style>
        body { font-family: 'Courier New', monospace; background: #111; color: #eee; padding: 20px; margin: 0; }
        h1 { border-bottom: 2px solid #FF4500; padding-bottom: 10px; display: flex; justify-content: space-between; }
        .clock { font-size: 1.2rem; color: #888; }
        
        .orders-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px; }
        
        .ticket { 
            background: #222; 
            border: 1px solid #444; 
            padding: 15px; 
            border-top: 5px solid #666; 
            box-shadow: 0 4px 10px rgba(0,0,0,0.5);
        }
        
        .ticket.delivery { border-top-color: #FF4500; } /* Orange for Delivery */
        .ticket.pickup { border-top-color: #27ae60; }   /* Green for Pickup */

        .ticket-header { display: flex; justify-content: space-between; font-weight: bold; font-size: 1.1rem; margin-bottom: 10px; border-bottom: 1px dashed #444; padding-bottom: 5px; }
        .ticket-meta { font-size: 0.85rem; color: #aaa; margin-bottom: 10px; }
        .ticket-items { font-size: 1rem; line-height: 1.5; margin-bottom: 15px; white-space: pre-wrap; }
        .ticket-total { font-weight: bold; text-align: right; font-size: 1.2rem; color: #FFD700; }
        
        .note { background: #330000; color: #ffcccc; padding: 5px; font-size: 0.8rem; margin-top: 5px; }
    </style>
</head>
<body>

    <h1>
        <span>üî• LIVE KITCHEN ORDERS</span>
        <span class="clock" id="clock">--:--</span>
    </h1>

    <div id="loading" style="color:#666;">Connecting to Database...</div>
    <div class="orders-grid" id="orders-container"></div>

    <script>
        // YOUR API URL IS INSERTED BELOW
        const scriptURL = 'https://script.google.com/macros/s/AKfycbx_6dCuYMLPAQq8j9AsMHzjIkcugifCOfCYQnI49eVUughBQlBYmdIY6LPf5PQ7EDmv/exec';

        function updateClock() {
            const now = new Date();
            document.getElementById('clock').innerText = now.toLocaleTimeString();
        }
        setInterval(updateClock, 1000);
        updateClock();

        fetch(scriptURL)
            .then(res => res.json())
            .then(data => {
                const container = document.getElementById('orders-container');
                document.getElementById('loading').style.display = 'none';
                container.innerHTML = '';
                
                // data[0] is headers. Start from index 1.
                // Reverse to show newest orders first.
                const rows = data.slice(1).reverse(); 

                if(rows.length === 0) {
                    container.innerHTML = '<div style="grid-column:1/-1; text-align:center; padding:50px; color:#444;">NO ACTIVE ORDERS</div>';
                    return;
                }

                rows.forEach(row => {
                    const typeClass = row[6] === 'Delivery' ? 'delivery' : 'pickup';
                    let itemsHtml = row[4].replace(/, /g, '<br>'); 
                    let noteHtml = row[8] && row[8] !== '-' ? `<div class="note">NOTE: ${row[8]}</div>` : '';
                    let addressHtml = row[6] === 'Delivery' ? `<div style="font-size:0.8rem; color:#888; margin-top:5px;">üìç ${row[7]}</div>` : '';

                    const html = `
                        <div class="ticket ${typeClass}">
                            <div class="ticket-header">
                                <span>#${row[1]}</span>
                                <span>${row[6].toUpperCase()}</span>
                            </div>
                            <div class="ticket-meta">
                                üïí ${new Date(row[0]).toLocaleString('en-IN', { hour: 'numeric', minute: 'numeric', hour12: true })}<br>
                                üë§ ${row[2]} (${row[3]})
                                ${addressHtml}
                            </div>
                            <div class="ticket-items">
                                ${itemsHtml}
                            </div>
                            ${noteHtml}
                            <div class="ticket-total">
                                Total: ‚Çπ${row[5]}
                            </div>
                        </div>
                    `;
                    container.innerHTML += html;
                });
            })
            .catch(err => {
                document.getElementById('loading').innerText = "Error loading orders. Check connection.";
                console.error(err);
            });
    </script>
</body>
</html>
