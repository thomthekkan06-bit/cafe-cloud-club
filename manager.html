<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manager Control</title>
    <style>
        body { font-family: sans-serif; padding: 20px; background: #222; color: white; max-width: 600px; margin: 0 auto; }
        input { width: 70%; padding: 15px; font-size: 20px; }
        button { padding: 15px; font-size: 20px; cursor: pointer; }
        .add-btn { background: #3b82f6; color: white; border: none; width: 25%; }
        .item { background: #333; margin: 10px 0; padding: 15px; display: flex; justify-content: space-between; align-items: center; }
        .ready-btn { background: #4ade80; border: none; padding: 10px; border-radius: 5px; margin-right: 5px;}
        .del-btn { background: #ef4444; color: white; border: none; padding: 10px; border-radius: 5px; }
    </style>
</head>
<body>
    <h2>Manager Control Panel</h2>
    
    <div>
        <input type="number" id="numInput" placeholder="Order #">
        <button class="add-btn" onclick="addOrder()">Add</button>
    </div>

    <div id="list"></div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getDatabase, ref, set, remove, onValue, update } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

        // YOUR KEYS ARE PRE-FILLED HERE:
        const firebaseConfig = {
          apiKey: "AIzaSyBEdTFc2eMatP-7c1uqX5CD5dMW6jYLu84",
          authDomain: "cafe-cloud-qds.firebaseapp.com",
          databaseURL: "https://cafe-cloud-qds-default-rtdb.asia-southeast1.firebasedatabase.app",
          projectId: "cafe-cloud-qds",
          storageBucket: "cafe-cloud-qds.firebasestorage.app",
          messagingSenderId: "277516157848",
          appId: "1:277516157848:web:1c5220480ac47cb4e961ed"
        };

        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);

        // 1. ADD ORDER (Manager "Accepts")
        window.addOrder = function() {
            const num = document.getElementById('numInput').value;
            if (!num) return;
            
            // We use the Order Number as the ID to make it easy
            set(ref(db, 'orders/' + num), {
                num: num,
                status: 'preparing'
            });
            document.getElementById('numInput').value = '';
        }

        // 2. MARK READY (Kitchen is done)
        window.markReady = function(num) {
            update(ref(db, 'orders/' + num), { status: 'ready' });
        }

        // 3. DELETE (Driver Picked Up)
        window.deleteOrder = function(num) {
            remove(ref(db, 'orders/' + num));
        }

        // SHOW LIST
        onValue(ref(db, 'orders'), (snapshot) => {
            const list = document.getElementById('list');
            list.innerHTML = '';
            const data = snapshot.val();
            
            if (data) {
                Object.keys(data).forEach(key => {
                    const order = data[key];
                    const div = document.createElement('div');
                    div.className = 'item';
                    div.innerHTML = `
                        <span>#${order.num} (${order.status})</span>
                        <div>
                            ${order.status === 'preparing' ? `<button class="ready-btn" onclick="markReady('${order.num}')">Ready</button>` : ''}
                            <button class="del-btn" onclick="deleteOrder('${order.num}')">Picked Up</button>
                        </div>
                    `;
                    list.appendChild(div);
                });
            }
        });
    </script>
</body>
</html>
